"use strict";(self.webpackChunkldo_docs=self.webpackChunkldo_docs||[]).push([[2656],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>d});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=r.createContext({}),c=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},u=function(e){var n=c(e.components);return r.createElement(l.Provider,{value:n},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},b=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=c(t),b=o,d=p["".concat(l,".").concat(b)]||p[b]||m[b]||a;return t?r.createElement(d,s(s({ref:n},u),{},{components:t})):r.createElement(d,s({ref:n},u))}));function d(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,s=new Array(a);s[0]=b;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[p]="string"==typeof e?e:o,s[1]=i;for(var c=2;c<a;c++)s[c]=t[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}b.displayName="MDXCreateElement"},969:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var r=t(7462),o=(t(7294),t(3905));const a={sidebar_position:3},s="Install Nginx Ingress - From Community",i={unversionedId:"Tool-Installation-Docs/Nginx-Ingress-Community",id:"Tool-Installation-Docs/Nginx-Ingress-Community",title:"Install Nginx Ingress - From Community",description:"Source - https://github.com/kubernetes/ingress-nginx",source:"@site/docs/Tool-Installation-Docs/03-Nginx-Ingress-Community.md",sourceDirName:"Tool-Installation-Docs",slug:"/Tool-Installation-Docs/Nginx-Ingress-Community",permalink:"/learndevopsonline/build/docs/Tool-Installation-Docs/Nginx-Ingress-Community",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Tool-Installation-Docs/03-Nginx-Ingress-Community.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Kubernetes Metrics Server on Kubernetes",permalink:"/learndevopsonline/build/docs/Tool-Installation-Docs/Install-Metrics-Server"}},l={},c=[],u={toc:c};function p(e){let{components:n,...t}=e;return(0,o.kt)("wrapper",(0,r.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"install-nginx-ingress---from-community"},"Install Nginx Ingress - From Community"),(0,o.kt)("p",null,"Source - ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/kubernetes/ingress-nginx"},"https://github.com/kubernetes/ingress-nginx")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-terraform"},'resource "helm_release" "ingress" {\n  depends_on = [null_resource.kubeconfig]\n  name       = "ingress-nginx"\n  repository = "https://kubernetes.github.io/ingress-nginx"\n  chart      = "ingress-nginx"\n\n  values = [\n    file("${path.module}/ingress.yml")\n  ]\n\n}\n')),(0,o.kt)("p",null,"For the above one to work, we need to have the ingress.yml file "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},'controller:\n  service:\n    annotations:\n      service.beta.kubernetes.io/aws-load-balancer-type: "nlb"\n      service.beta.kubernetes.io/aws-load-balancer-cross-zone-load-balancing-enabled: "true"\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"By default nginx ingress will create a Classic load balancer, In order to get the network load balancer we are going to use annotation ",(0,o.kt)("inlineCode",{parentName:"p"},'service.beta.kubernetes.io/aws-load-balancer-type: "nlb"'))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"NLB supports cross availability zone load balancing To enable it we are using ",(0,o.kt)("inlineCode",{parentName:"p"},'service.beta.kubernetes.io/aws-load-balancer-cross-zone-load-balancing-enabled: "true"')," Ref link: ",(0,o.kt)("a",{parentName:"p",href:"https://aws.amazon.com/about-aws/whats-new/2018/02/network-load-balancer-now-supports-cross-zone-load-balancing/"},"https://aws.amazon.com/about-aws/whats-new/2018/02/network-load-balancer-now-supports-cross-zone-load-balancing/")))),(0,o.kt)("p",null,"To monitor the nginx ingress with prometheus, we need to scrape the metrics. So to scrape metrics thise needs to be exported. Hence we are using metrics to be enabled and giving port information."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},'controller:\n  service:\n    annotations:\n      service.beta.kubernetes.io/aws-load-balancer-type: "nlb"\n      service.beta.kubernetes.io/aws-load-balancer-cross-zone-load-balancing-enabled: "true"\n  metrics:\n    enabled: true\n  podAnnotations:\n    prometheus.io/port: "10254"\n    prometheus.io/scrape: "true"\n')))}p.isMDXComponent=!0}}]);